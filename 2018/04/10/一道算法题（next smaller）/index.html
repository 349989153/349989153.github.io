<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>一道算法题（next smaller） | 陆扬的个人博客</title><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><script src="/js/third-party/jquery.min.js">           </script><script src="/js/third-party/velocity.min.js">           </script><script src="/js/third-party/velocity.ui.min.js">           </script><link rel="icon" href="/img/favicon.ico"></head><body><nav id="nav-bar"><nav class="clear-fix" id="nav-container"><div class="pull-left" id="page-home"><a href="/">陆扬的个人博客</a></div><i class="fa fa-bars pull-right" id="toggle-nav" aria-hidden="true"></i><ul class="pull-right" id="navs"><li><a class="nav" href="/">Home</a></li><li><a class="nav" href="/about">About</a></li><li><a class="nav" href="/tags">Tags</a></li><li><a class="nav" href="/categories">Categories</a></li></ul></nav></nav><header id="header-info"><div id="header-container"><div id="site-info"><div id="terminal-pl"><div id="top-bar"><ul id="control"><li class="btn"></li><li class="btn"></li><li class="btn"></li></ul><div id="file-path"><i class="fa fa-folder folder-ic" aria-hidden="true"></i> 349989153 10 X 10</div></div><div id="code-pl">Last updated: 2018-04-10<br>349989153:~ Desktop$ <span class="code-pl-input">node 一道算法题（next smaller）.js</span><br><br>> Post.tags <br><a class="tag" href="#js"><span>js</span></a><a class="tag" href="#算法"><span>算法</span></a><br><br>> Post.prev <br><a href="/2018/04/10/NodeJS验证微信开发平台的token/"><span class="answer">NodeJS验证微信开发平台的token</span></a><br><br>> Post.next <br><a href="/2018/04/10/三目（三元）运算符-的形式/"><span class="answer">三目（三元）运算符??::的形式</span></a></div></div></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><a class="article-title">一道算法题（next smaller）</a><time class="article-date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-04-10</time><p>挺有意思的一道题，这题的重点是数学理解。</p>
<a id="more"></a>
<hr>
<h2 id="题目如下："><a href="#题目如下：" class="headerlink" title="题目如下："></a>题目如下：</h2><p>给定某一个正整数，组成这个数的数字不变，返回下一个比它小的数，如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nextSmaller(<span class="number">21</span>) == <span class="number">12</span></span><br><span class="line">nextSmaller(<span class="number">531</span>) == <span class="number">513</span></span><br><span class="line">nextSmaller(<span class="number">907</span>) == <span class="number">790</span></span><br><span class="line">nextSmaller(<span class="number">51226262651257</span>) == <span class="number">51226262627551</span></span><br></pre></td></tr></table></figure>
<p>如果没有下一个比它小的数字，或者下一个比它小的数字以0开头，则返回-1，如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nextSmaller(<span class="number">9</span>) == <span class="number">-1</span></span><br><span class="line">nextSmaller(<span class="number">111</span>) == <span class="number">-1</span></span><br><span class="line">nextSmaller(<span class="number">135</span>) == <span class="number">-1</span></span><br><span class="line">nextSmaller(<span class="number">1027</span>) == <span class="number">-1</span> <span class="comment">// 0721以0开头，所以返回-1</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="算法描述（找到下一个比它小的数）："><a href="#算法描述（找到下一个比它小的数）：" class="headerlink" title="算法描述（找到下一个比它小的数）："></a>算法描述（找到下一个比它小的数）：</h2><p><strong>1.find pivot：</strong>这个数从右往左，一位位地来比较，如果第i位的数字，比第i+1位的数字大，则把第i位的数字置为pivot（标志位）。<br><strong>2.swap：</strong>从pivot位向右，找到比pivot小的最大的那个数，并与pivot交换。<br><strong>3.sort：</strong>交换后，把pivot位向右（注意是pivot的index，不是pivot的值）的所有数字降序排列。<br>这样，新得到的数就是下一个比它小的数。</p>
<hr>
<h2 id="举例分析："><a href="#举例分析：" class="headerlink" title="举例分析："></a>举例分析：</h2><p>比如我们拿54123来分析。<br><strong>1.find pivot：</strong>从最右边的3来看，因为3没有第i+1位数字（3没有右边），所以左移一位到2；2比右边的3小，所以继续左移一位到1；同理，1也比2要小，所以继续左移一位到4；4比1要大了，那么把4置为pivot，这时停止。<br><strong>2.swap：</strong>现在4是pivot，那么从4向右，有1，2，3三个数字，并且都比4小，这其中3是最大的，所以把4和3的位置交换，得到53124。<br><strong>3.sort：</strong>交换后，pivot位上是3，把3往右的所有数字降序排列，得到53421，这就是下一个比54123小的数。</p>
<hr>
<h2 id="为什么这样做？"><a href="#为什么这样做？" class="headerlink" title="为什么这样做？"></a>为什么这样做？</h2><p>下面是我自己思考的为什么，不一定对。</p>
<p>对于每个数，它最小的排列只有1种情况，就是权位从高到低，数字从小到大排列。<br>比如123的最小排列就是123。<br>对于54123来说，从右向左可以分割为3，23，123，这三种情况都是最小排列。<br>也就是说，如果我们只对3或者23或者123进行重组，是没有变化的。<br>于是再向左进行分割，得到5和4123，发现4123已经不再是最小排列了，换句话说4123肯定有下一个比它小的数，就把4标记出来，对4123进行重组。<br>怎么重组呢？最高的权位，放上比4稍小的，也就是3，然后对于3xxx的后三位，放上值最大的情况，就是412的降序排列421，这样就能保证“3421是4123的上一个数”。</p>
<hr>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>这个算法一句话总结：对于某个数，从右向左找它的子列，如果子列是最小排列，那子列没法重组，继续向右；如果子列不是最小排列，就对子列进行重组。</p>
<p>感觉算法里，“分治”加“pivot（标志位）”的解法很常用啊，把复杂情况分成最简单的子情况，如果符合规律，那么子情况扩充，如果不符合规律，那么置上标志位，再进行考虑。</p>
<hr>
<h2 id="下面是写得不怎么样的代码："><a href="#下面是写得不怎么样的代码：" class="headerlink" title="下面是写得不怎么样的代码："></a>下面是写得不怎么样的代码：</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nextSmaller</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arr = [];</span><br><span class="line">  (num + <span class="string">""</span>).split(<span class="string">""</span>).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">val</span>) </span>&#123;</span><br><span class="line">    arr.push(<span class="built_in">parseInt</span>(val));</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 1st: find the pivot, if digit is greater than its right digit, it becomes a pivot</span></span><br><span class="line">  <span class="keyword">var</span> pivot = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = arr.length - <span class="number">2</span>; i &gt;= <span class="number">0</span>;i--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (arr[i] &gt; arr[i + <span class="number">1</span>]) &#123;</span><br><span class="line">      pivot = i;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 2nd: find the least less than the pivot, and swap them</span></span><br><span class="line">  <span class="keyword">var</span> swap = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = pivot + <span class="number">1</span>;i &lt; arr.length;i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (swap &lt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[i] &lt; arr[pivot]) &#123;</span><br><span class="line">        swap = i;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[i] &lt; arr[pivot] &amp;&amp; arr[i] &gt; arr[swap]) &#123;</span><br><span class="line">        swap = i</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> _mem;</span><br><span class="line">  _mem = arr[pivot];</span><br><span class="line">  arr[pivot] = arr[swap];</span><br><span class="line">  arr[swap] = _mem;</span><br><span class="line">  <span class="keyword">if</span> (arr[<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 3rd: sort the right of pivot, decreasingly</span></span><br><span class="line">  <span class="keyword">var</span> firstArray = arr.slice(<span class="number">0</span>, pivot + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">var</span> secondArray = arr.slice(pivot + <span class="number">1</span>);</span><br><span class="line">  secondArray.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b -a;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 4th: return val</span></span><br><span class="line">  <span class="keyword">var</span> result = (firstArray.concat(secondArray)).join(<span class="string">""</span>);</span><br><span class="line">  <span class="keyword">if</span> (result == num)&#123;</span><br><span class="line">    <span class="keyword">return</span> - <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">parseInt</span>(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><nav id="pagination"><div class="pagination clear-fix"><div class="page-prev pull-left"><a href="/2018/04/10/NodeJS验证微信开发平台的token/"><i class="fa fa-chevron-left"> </i><span>NodeJS验证微信开发平台的token</span></a></div><div class="page-next pull-right"><a href="/2018/04/10/三目（三元）运算符-的形式/"><span>三目（三元）运算符??::的形式</span><i class="fa fa-chevron-right"></i></a></div></div></nav></div></div><footer><div id="footer-inner"><div class="social-icons"></div><p class="design-info">power by <a href="https://hexo.io" target="_blank">Hexo</a> | theme <a href="https://github.com/lazysheep666/terminal_theme" target="_blank">Teminal</a></p><p class="copyright">Copyright © 349989153 Blog 2018</p></div></footer><script src="/js/nav.js"></script><script src="/js/scroll.js"></script><script src="/js/index.js"></script></body></html>